总体逻辑就是通过 配置现有的设备到llm，然后让llm输出结构化命令进行输出
但是怎么让1.5B1B甚至是0.5B的模型输出结构化指令，做了以下几种尝试
## 提示词控制
这是最原来的想法，就是像大模型一样通过提示词来进行结构化的输出
比如提示词如下
![](../../file/Pasted%20image%2020250522152939.png)
然后我直接说系统指令里的给出的示例
![](Pasted%20image%2020251128111508.png)
![](Pasted%20image%2020251128111525.png)
他都没办法实现

## 模型微调
随后发现了这样一个仓库：https://github.com/acon96/home-llm
他已经实现了3B左右的模型的微调，通过构建的数据集可以让模型输出结构化的指令

构建的数据集如下：
![](Pasted%20image%2020251128111908.png)
系统指令都是随机的设备+服务，表示目前房子里可用的设备，然后从预置的命令列表中选择命令和回复，匹配好系统指令中的设备和服务，微调数据集就诞生了

但是他这个数据集有两个比较明显的缺陷：
1、没有设计找不到设备的情况，模型可能会控制错误的设备
2、没有设计‘你能控制什么设备’的情况，模型不仅不能回答类似的问题，最主要可能对设备列表的理解能力不够

所以我改进了作者发布的数据集：
1、增加找不到设备的回复，就是控制系统指令中不存在的设备，然后让模型回复预设的‘devices not found’之类的回复，实测下来效果比较好，一些垃圾文本也可以过滤掉
2、增加了‘what device can you contral’类似的命令，让模型回复系统指令中的设备列表， 这样在使用的时候不仅可以回复类似的问题，隐约感觉设备名输出也更准确，虽然有时候还是张冠李戴，比如错误的匹配区域+设备




