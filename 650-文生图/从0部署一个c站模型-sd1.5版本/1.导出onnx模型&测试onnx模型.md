首先在自己pc的环境中，安装好相关的依赖，依次运行下列的代码。
加载safetensor进行推理：
```
python safetensor_infer.py \
    --input_path "./s/xxmix9realistic_v40.safetensors" \
    --output_path "./test_output" \
    --negative_prompt "easynegative,ng_deepnegative_v1_75t,(worst quality:2),(low quality:2),(normal quality:2),lowres,bad anatomy,bad hands,normal quality,((monochrome)),((grayscale)),((watermark))," \
    --prompt "1girl, upper body, (huge Laughing),sweety,sun glare, bokeh, depth of field, blurry background, light particles, strong wind,head tilt,simple background, red background,<lora:film:0.4>" 
```
推理结果：
![](test_dpm_no_lora_steps_20%203.jpg)


导出onnx模型
```
python export_onnx.py --input_path ./s/xxmix9realistic_v40.safetensors --output_path ./out_onnx --isize 480x320 --prompt "1girl, upper body, (huge Laughing),sweety,sun glare, bokeh, depth of field, blurry background, light particles, strong wind,head tilt,simple background, red background,<lora:film:0.4>"
```

- 320x480 是横图，480x320 是竖图，也可以写 512x512，但是再大就会报错了，这里的尺寸要和后面vae等处的尺寸对应，有8倍的缩放
- prompt可以在模型的示例图中找一个，用来验证模型的原本的生成效果，但是由于固定了采样器类型，修改了分辨率等原因，所以可能和网页上有差距

运行完毕后会生成对应模型


注意：没有导出文本编码器模型，原因有2：1、ax给的导出demo环境有问题，导致一直导不出来 2、文本编码器都是用的clip，没有任何改动，所以也没必要导了




# onnx推理
运行
```
python dpm_infer.py
```

正向提示词：
beautiful Chinese Landscape Art, medium detail, intricate, water colors, ((less vibrant colors))
负面提示词：
deformed, weird, bad resolution, bad depiction, not Chinese style, weird, has people, worst quality, worst resolution, too blurry, not relevant, weird color spots, weird colors, bad coloring
![](../../file/txt2img_output_onnx%203.png)

提示词增加：一群飞鸟-a flock of birds

![](../../file/txt2img_output_onnx%202.png)
没有效果


提示词增加：亭台楼阁-pavilions, terraces, towers
![](../../file/txt2img_output_onnx%204.png)

提示词增加：满山桃树，开满粉色的桃花，落花缤纷 - Full of peach trees, pink peach blossoms in full bloom, colorful fallen flowers
![](../../file/txt2img_output_onnx%205.png)




```
python safetensor_infer.py \
    --input_path "./s/darkSushiMixMix_225D.safetensors" \
    --output_path "./output" \
    --prompt "1girl,beautiful,starlit meadow" \
    --negative_prompt "open cloth,pornographic,violence,wearing less,signature, soft, blurry, drawing, sketch, poor quality, ugly, text, type, word, logo, pixelated, low resolution, saturated, high contrast, oversharpened" \
    --scheduler unipc \
    --steps 10 \
    --guidance_scale 2.5
```



```
python safetensor_infer.py \
    --input_path "./s/darkSushiMixMix_225D.safetensors" \
    --output_path "./output" \
    --prompt "1girl,beautiful,starlit meadow" \
    --negative_prompt "open cloth,pornographic,violence,wearing less,signature, soft, blurry, drawing, sketch, poor quality, ugly, text, type, word, logo, pixelated, low resolution, saturated, high contrast, oversharpened" \
    --scheduler dpm \
    --steps 20
```









```
python safetensor_infer_fixseed_cfg1-7.py \
    --input_path "./s/darkSushiMixMix_225D.safetensors" \
    --output_path "./output" \
    --prompt "1girl,starlit meadow,yellow eyes,black coat|1boy,starlit meadow,yellow eyes,black coat" \
    --negative_prompt "open cloth,pornographic,violence,wearing less,signature, soft, blurry, drawing, sketch, poor quality, ugly, text, type, word, logo, pixelated, low resolution, saturated, high contrast, oversharpened" \
    --fixed_seed
```
